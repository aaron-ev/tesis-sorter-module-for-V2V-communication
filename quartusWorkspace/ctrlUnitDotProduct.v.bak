
module ctrlUnitDotProduct#(parameter ADDR_WIDTH = 3)
(
	input clk,
	input rst, 
	input start,
	output reg we,
	output reg [ADDR_WIDTH-1:0] addr
);

localparam IDLE = 1'd0;
localparam LOAD = 1'd1;

reg state,nextState;

always@(posedge clk,negedge rst) 
	begin
		if(!rst)
			state <= IDLE;
		else 
			state <= nextState;
	end

always@(posedge clk,negedge rst) 
	begin
		if(!rst)
				addr <= 0; 	
		else 
			if(nextState == IDLE) 
				addr <= 0; 
			else 
				begin 
					if(state == LOAD)
						addr <= addr + 1;
					else 
						addr <= addr; 
				end
	end
	
always @(state)
	begin 
		case(state)
			IDLE:	begin
						we <= 0;
						if(start)
							nextState <= LOAD;
						else 
							nextState <= IDLE;
					end
			LOAD: begin 
						we <= 1;
						if(start == 0 && addr == 4)
							nextState <= IDLE;
						else 
							nextState <= LOAD;
					end
			default: begin 
							we <= 0;
							nextState <= IDLE;
						end 
		endcase
	end
	
endmodule